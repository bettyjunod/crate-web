title: Crate & Amazon Web Services (AWS)
description: Amazon's cloud (AWS) is a great way to run a Crate cluster.  Here, we'll go over just the basics of getting a 3 node cluster running using Docker.
logo: /static/images/aws-logo.png

{% extends "install.html" %}

{% block install_content %}

<div class="row">
  <div class="col-sm-8">

    <p>
      Amazon Web Services (AWS) is the worlds most popular cloud hosting provider with 1000s of options for platforms, applications and infrastructure.
    </p>
    <p>
      An AMI (Amazon Machine Image) is a pre-configured virtual appliance optimized for a particular use. With the Crate AMI, this includes dependencies, optimization and configuration to get Crate running as quickly and efficiently as possible. Using the AMI is our recommended method for running Crate clusters on AWS.
    </p>
    <h2>With the AWS Command Line Interface</h2>
    <p>
      You can find the Crate AMI via the command line interface, in the format <i>crate-&lt;VERSION&gt;-&lt;REV&gt;-&lt;BASE_AMI&gt;</i>.
    </p>
    <p>
      For example, to find all Crate AMIs available:
    </p>
    <pre><code>
aws ec2 describe-images --filters "Name=name,Values=crate-*"
    </code></pre>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/terminal-output.png' %}" />
    <p>
      If you are looking for particular Crate version, you can be more precise:
    </p>
    <pre><code>
aws ec2 describe-images --filters "Name=name,Values=crate-0.51.1-1-amzn-*"
    </code></pre>
    <p>
      To run instances based on your AMI of choice, run the following command with the <code>image-id</code> of the Crate version you wish to run, the name of a security group that allows the ports Crate requires (4200, 4300) and if you want to use the EC2 API for inter-node discovery, a link to a <code>user-data</code> script.
    </p>

    <pre><code>
aws ec2 run-instances --image-id ami-96702de1 --count <i>x</i> --instance-type m3.medium --user-data $(base64 user-data.sh) --key-name <i>keyname</i> --security-groups <i>groupname</i>
      </code></pre>

    <h2>With the AWS Web Interface</h2>

    <p>
      To use the AWS website to launch an instance, click the blue 'Launch Instance' button and find the available Crate AMIs under the <i>Community AMIs</i> section.
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/crate-gui.png' %}" />
    <p>
      Click the 'select' button on the AMI you wish to use and set the instance configuration. The most important options here are the number of instances you require and selecting a security group that opens ports 4200 and 4300.
    </p>

    <h2>The User Data file</h2>
    <p>
      Amongst other configuration options, the User Data file is primarily used for setting your AWS credentials to make use of the EC2 API for inter-node discovery.</p>
      <p>
        For example:
      </p>
    </p>
    <pre><code>
#!/bin/bash
echo "
export AWS_ACCESS_KEY_ID='<your_access_key_id>'
export AWS_SECRET_ACCESS_KEY='<your_secret_access_key>'
" >> /etc/sysconfig/crate
          </code></pre>
        <h2>More Details</h2>
        <p>
          For more options and details on setting up a Crate cluster on AWS with our AMI, read <a href="/docs/en/latest/best_practice/crate_ami.html">our best practice guide</a>. For more details on running Crate with Docker on AWS, <a href="/blog/running-crate-with-docker-aws/">read our blog post</a>.
        </p>
      </div>
      <div class="col-sm-4">
        <img class="img-responsive" src="{% static logo %}" />
        <hr />
        {% include "cloud-template-list.html" %}
      </div>
    </div>

    {% endblock %}
