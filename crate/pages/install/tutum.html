title: Install with tutum

{% extends "install.html" %}

{% block install_content %}

<div class="row">
  <div class="col-lg-12">
    <p class="lead"><a href="https://www.tutum.co/" target="_blank">Tutum</a> is platform for building, managing and deploying Docker containers across a variety of cloud providers and a provides many features ideal for Development workflows. One of the best and most relevant features for Crate users is <a href="http://blog.tutum.co/2015/03/03/introducing-overlay-networking-for-containers-and-dynamic-links-in-tutum/" target="_blank">default support for overlay networking with Weave</a>. Whilst Crate <a href="/docs/stable/configuration.html#discovery">offers multiple options for Unicast host discovery</a>, when multicast is unavailable, this default support is a positive.</p>
    <h2>Create Hosting Nodes</h2>
    <p>
      The first step is to create some 'nodes', these are machine instances on your cloud hosting provider(s) of choice and includes Amazon Web Services, Digital Ocean, Microsoft Azure, Softlayer and Packet.
    </p>
    <p>
      Visit the 'nodes' section of the <a href="https://dashboard.tutum.co/node/cluster/list/">Tutum dashboard</a> and click the large green 'Launch new node cluster' button. Give the cluster a name, select the details of your cloud provider and give the cluster a tag that we use to group and target services.
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/tt_create_node_cluster.png' %}" />
    <p>
      After a couple of minutes, the cluster will be ready.
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/tt_node_cluster.png' %}" />
    <p>
      And here are the new instances on Digital Ocean (in my case).
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/tt_cluster_do.png' %}" />
    <h2>Create Services</h2>
    <p>
      Next we need to setup our services. Tutum provide an amazing selection of configuration and management options through their UI, but by far the easiest and quickest method for getting a Crate cluster deployed is by using a 'Stack' file. This allows us to set some options that Crate needs to function correctly and then you can analyse the resulting services to see what Tutum is capable of.
    </p>
    <p>
      Click on the <i>Stacks</i> tab, give your Stack a name and add the following code:
    </p>
    <pre>
      <code>
crate1:
  image: 'crate:latest'
  command: 'crate -Des.network.publish_host=_ethwe:ipv4_'
  ports:
    - '4200:4200'
    - '4300:4300'
crate2:
  image: 'crate:latest'
  command: 'crate -Des.network.publish_host=_ethwe:ipv4_'
crate3:
  image: 'crate:latest'
  command: 'crate -Des.network.publish_host=_ethwe:ipv4_'
      </code>
    </pre>

    <p>
      This creates three instances of Crate, all using the 'latest' tagged Docker image. One sets ports manually and the others use dynamic port allocation. Finally, we change the default <a href="/docs/stable/configuration.html#conf-hosts">publish_host</a>. We do this because Tutum has default support for Weave, which allows for seamless cross machine communication through its overlay network. However, Weave requires Crate to publish on a different interface to its default and this is how we accomplish this.
    </p>
    <p>
      Click the green 'Create stack' button and you will see a list of the resulting services not yet running.
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/tt_services_created.png' %}" />
    <p>
      Click the green 'Start' button and after a few moments you will see our 3 node Crate cluster spread across containers and nodes. We have used Tutum's default approach to load balancing (Emptiest Node) but <a href="https://support.tutum.co/support/solutions/articles/5000050235-load-balancing-a-web-service" target="_blank">there are many to choose from</a>. As we are setting one set of ports manually, this will limit some of our potential deployment strategies.
    </p>
    <p>
      Click the 'Endpoints' tab to see the cluster URL and open the link ending in port 4200, adding <i>/admin</i> to access the Crate admin interface. You should see a 3 node cluster, indicated by the '3' in the top right of the window.
    </p>
    <p>
      To double check what is happening, click the 'Nodes' tab, you should see our two VMs, one with 1 container and 1 with 2.
    </p>
    <img class="img-responsive thumbnail" src="{% media '/media/1508/tt_cluster_node_spread.png' %}" />
    <h2>Conclusion</h2>
    <p>
      The real potential in Tutum lies in its simple scalability through a user-friendly UI (and CLI) which pairs well with Crate, this has been a simple, 'getting started' example and we recommend you look further at <a href="https://support.tutum.co/support/solutions/5000042949" target="_blank">Tutum's documentation</a> to explore its full potential.
    </p>


    <h2>Further Reading</h2>
    <ul>
      <li><a href="{% url '/docker/index.html' %}">Docker</a></li>
      <li><a href="{% url '/docker/machine.html' %}">Docker Machine</a></li>
      <li><a href="http://weaveblog.com/2015/01/07/crate-with-docker-weave/">Crate with Docker &amp; Weave</a></li>
      <li><a href="{% url '/install/cloud/gce.html' %}">Crate &amp; Google Compute Engine</a></li>
    </ul>

  </div>
</div>

{% endblock %}
